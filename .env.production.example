# ===========================================
# AIエージェントサービス 本番環境設定
# ===========================================
# 本番環境: https://tools.cross-astem.jp/zm

# ---------------------------
# 基本設定
# ---------------------------
NODE_ENV=production
PORT=8000

# サブパス設定
BASE_PATH=/zm
ASSET_PREFIX=/zm
PUBLIC_URL=https://tools.cross-astem.jp/zm

# ---------------------------
# データベース設定（本番）
# ---------------------------
# 本番データベース接続（外部シークレット管理から取得）
DATABASE_URL=${DATABASE_URL}

# 接続プール設定
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000

# ---------------------------
# Redis設定（本番）
# ---------------------------
REDIS_URL=${REDIS_URL}
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}

# ---------------------------
# 認証設定（本番）
# ---------------------------
# NextAuth.js（本番）
NEXTAUTH_URL=https://tools.cross-astem.jp/zm
NEXTAUTH_SECRET=${NEXTAUTH_SECRET}

# JWT（本番）
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRES_IN=24h

# ---------------------------
# AI サービス API（本番）
# ---------------------------
# OpenAI（本番キー）
OPENAI_API_KEY=${OPENAI_API_KEY}

# Anthropic Claude（本番キー）
ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}

# ---------------------------
# Zoom API設定（本番・Server-to-Server OAuth）
# ---------------------------
ZOOM_ACCOUNT_ID=${ZOOM_ACCOUNT_ID}
ZOOM_CLIENT_ID=${ZOOM_CLIENT_ID}
ZOOM_CLIENT_SECRET=${ZOOM_CLIENT_SECRET}
ZOOM_WEBHOOK_SECRET=${ZOOM_WEBHOOK_SECRET}

# Webhook URL（本番）
ZOOM_WEBHOOK_URL=https://tools.cross-astem.jp/zm/api/webhooks/zoom

# ---------------------------
# メール配信設定（本番）
# ---------------------------
# SMTP設定（本番）
SMTP_HOST=${SMTP_HOST}
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=${SMTP_USER}
SMTP_PASS=${SMTP_PASS}

# 送信者情報（本番）
SMTP_FROM=ai-agent@cross-astem.jp
SMTP_FROM_NAME=AIエージェント 議事録配布システム

# 管理者メール（本番）
ADMIN_EMAIL=admin@cross-astem.jp

# ---------------------------
# WorkflowAPI連携（本番）
# ---------------------------
WORKFLOW_API_BASE_URL=https://tools.cross-astem.jp/workflow/api
WORKFLOW_API_TOKEN=${WORKFLOW_API_TOKEN}
WORKFLOW_API_TIMEOUT=30000

# ---------------------------
# Slack連携（本番）
# ---------------------------
SLACK_BOT_TOKEN=${SLACK_BOT_TOKEN}
SLACK_WEBHOOK_URL=${SLACK_WEBHOOK_URL}

# ---------------------------
# フロントエンド設定（本番）
# ---------------------------
BACKEND_API_URL=https://tools.cross-astem.jp/zm/api

# Next.js公開設定
NEXT_PUBLIC_API_URL=https://tools.cross-astem.jp/zm/api
NEXT_PUBLIC_BASE_PATH=/zm

# ---------------------------
# セキュリティ設定（本番）
# ---------------------------
# CORS許可ドメイン
CORS_ORIGINS=https://tools.cross-astem.jp

# Rate Limiting（本番）
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# セッションセキュリティ
SESSION_SECURE=true
SESSION_SAME_SITE=strict

# ---------------------------
# ログ設定（本番）
# ---------------------------
LOG_LEVEL=warn
LOG_FILE=/var/log/ai-agent/app.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=10

# 構造化ログ
LOG_FORMAT=json
LOG_TIMESTAMP=true

# ---------------------------
# パフォーマンス設定（本番）
# ---------------------------
# Bull Queue設定
QUEUE_CONCURRENCY=5
QUEUE_MAX_ATTEMPTS=3
QUEUE_BACKOFF_DELAY=5000

# ワーカー設定
TRANSCRIPT_WORKER_CONCURRENCY=2
EMAIL_WORKER_CONCURRENCY=5

# メモリ制限
NODE_MAX_OLD_SPACE_SIZE=2048

# ---------------------------
# 監視・メトリクス設定
# ---------------------------
# ヘルスチェック
HEALTH_CHECK_INTERVAL=30000

# メトリクス出力
METRICS_ENABLED=true
METRICS_PORT=9090

# ---------------------------
# SSL・証明書設定
# ---------------------------
# SSL証明書パス（Let's Encrypt等）
SSL_CERT_PATH=/etc/letsencrypt/live/tools.cross-astem.jp/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/tools.cross-astem.jp/privkey.pem

# ---------------------------
# 外部サービス連携
# ---------------------------
# AWS設定（必要に応じて）
# AWS_REGION=ap-northeast-1
# AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
# AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}

# S3バケット（ファイル保存用）
# S3_BUCKET=ai-agent-files
# S3_REGION=ap-northeast-1

# ---------------------------
# バックアップ設定
# ---------------------------
# データベースバックアップ
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# ファイルバックアップ
FILE_BACKUP_PATH=/var/backups/ai-agent

# ---------------------------
# 本番環境特有の設定
# ---------------------------
# プロセス管理
PM2_INSTANCES=max
PM2_MAX_MEMORY_RESTART=1G

# キャッシュ設定
CACHE_TTL=3600
CACHE_MAX_SIZE=100

# 圧縮設定
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6

# ---------------------------
# 環境変数の検証
# ---------------------------
# 必須環境変数チェック
REQUIRED_ENV_VARS=DATABASE_URL,JWT_SECRET,NEXTAUTH_SECRET,OPENAI_API_KEY,ANTHROPIC_API_KEY,ZOOM_API_KEY

# ---------------------------
# 設定値の説明（本番環境）
# ---------------------------
# BASE_PATH: サブパス設定（/zm）
# PUBLIC_URL: 外部アクセス用URL
# CORS_ORIGINS: CORS許可ドメイン（本番ドメインのみ）
# LOG_LEVEL: 本番では warn 以上のみ出力
# QUEUE_CONCURRENCY: 同時処理ジョブ数（本番では控えめ）
# SSL_*_PATH: SSL証明書のパス
# BACKUP_*: 自動バックアップ設定